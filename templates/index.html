{% extends 'base.html' %}
{% block title %}Sistema de Sirene Escolar{% endblock %}

{% block content %}
<div class="container">
    <div class="header">
        <h1>üîî Sistema de Sirene Escolar</h1>
        <p>Gerenciamento de Hor√°rios - Dire√ß√£o</p>
    </div>

    <div id="status" class="status">
        Sistema Ativo - Pr√≥ximo toque: <span id="proximo-toque">--:--</span>
    </div>

    <div class="content">
        <div class="form-section">
            <h2>‚ûï Agendamentos j√° cadastrados</h2>

            {% if alarms %}
        <div class="table-responsive">
            <table class="table table-striped">
                <thead class="thead-dark">
                    <tr>
                        <th>Tipo</th>
                        <th>Hor√°rio</th>
                        <th>Dias</th>
                        <th>Per√≠odo</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for alarm in alarms %}
                    <tr>
                        <td>{{ alarm.get_event_type_display }}</td>
                        <td>{{ alarm.time|time:"H:i" }}</td>
                        <td>
                            {% for day in alarm.days_of_week.split %}
                                <span class="badge bg-primary">{{ day }}</span>
                            {% endfor %}
                        </td>
                        <td>{{ alarm.start_date|date:"d/m/Y" }} a {{ alarm.end_date|date:"d/m/Y" }}</td>
                        <td>
                            <a href="{% url 'app:alarm-update' alarm.pk %}" class="btn btn-sm btn-warning">
                                <i class="fas fa-edit"></i> Editar
                            </a>
                            <a href="{% url 'app:alarm-delete' alarm.pk %}" class="btn btn-sm btn-danger">
                                <i class="fas fa-trash"></i> Excluir
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
{% else %}
    <div class="alert alert-info">
        Nenhum agendamento ativo encontrado para hoje.
    </div>
{% endif %}
            <div class="form-group mt-3">
                <a href="{% url 'app:alarm-create' %}" class="btn">‚ûï Criar novo Agendamento</a>
            </div>
        </div>
    </div>
<form id="sirenForm" action="{% url 'app:ativar-campainha' %}" method="post">
  {% csrf_token %}
  <button type="button" class="btn btn-primary" onclick="triggerSiren()">Tocar campainha</button>
</form>
</div>
{% endblock %}
